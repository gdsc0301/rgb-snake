var k=Object.defineProperty;var b=(i,t,e)=>t in i?k(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var s=(i,t,e)=>(b(i,typeof t!="symbol"?t+"":t,e),e),D=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var h=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)};var c=(i,t,e)=>(D(i,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const w of a.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&o(w)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();class P{constructor(t,e,o){s(this,"x");s(this,"y");s(this,"style");s(this,"parentPlayer");this.x=o.x+(t+1)*t,this.y=o.y+(e+1)*e,this.parentPlayer=o}setPosition(t){this.x=t.x,this.y=t.y}get position(){return{x:this.x,y:this.y}}draw(t){t.fillStyle=this.style;const e=new Path2D;e.rect(this.x,this.y,this.parentPlayer.partsSize,this.parentPlayer.partsSize),t.fill(e)}}const n={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight"};var f,v,y,L,u,S;class E{constructor(t,e,o,r){h(this,f);h(this,y);h(this,u);s(this,"username");s(this,"x");s(this,"y");s(this,"direction");s(this,"game");s(this,"parts",[]);s(this,"partsSize",32);s(this,"tick",0);s(this,"maxSpeed",16);this.username=t,this.game=e,this.x=o,this.y=r,this.direction=n.Up,c(this,f,v).call(this)}setPosition(t,e){const o={x:this.x-t,y:this.y-e};this.x=t,this.y=e,this.parts.forEach(r=>{r.x+=o.x,r.y+=o.y})}update(){this.tick++,this.tick===Math.min(10,this.maxSpeed-Math.floor(this.parts.length/this.maxSpeed))&&(this.tick=0,c(this,u,S).call(this))}draw(t){t.fillStyle=this.game.GameColors.five,console.log(this.username),t.fillText(`${this.username} | ${this.parts.length-3}`,this.x+this.partsSize+6,this.y),this.parts.forEach((e,o)=>{e.style=this.game.GameColors[Object.keys(this.game.GameColors)[o]],e.draw(t)})}}f=new WeakSet,v=function(){for(let t=0;t<3;t++)this.parts.push(new P(0,t,this));window.addEventListener("keydown",t=>c(this,y,L).call(this,t))},y=new WeakSet,L=function(t){switch(t.key){case n.Up:this.direction=n.Up;break;case n.Down:this.direction=n.Down;break;case n.Left:console.log("GO TO LEFT"),this.direction=n.Left;break;case n.Right:this.direction=n.Right;break}},u=new WeakSet,S=function(){const t=this.partsSize+1;switch(this.direction){case n.Up:this.y-=t;break;case n.Down:this.y+=t;break;case n.Left:this.x-=t;break;case n.Right:this.x+=t;break}for(let e=this.parts.length-1;e>0;e--)this.parts[e].setPosition(this.parts[e-1].position);this.parts[0].setPosition({x:this.x,y:this.y})};var d,g,x,T;class O{constructor(t,e){h(this,d);h(this,x);s(this,"initialTime");s(this,"time");s(this,"score",0);s(this,"player");s(this,"canvas");s(this,"ctx");s(this,"gameLoop");s(this,"GameColors",{one:"#591202",two:"#F28157",three:"#BF4904",four:"#03A6A6",five:"#04D9D9"});this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.player=new E(t,this,this.canvas.width/2,this.canvas.height/2),this.initialTime=new Date}init(){return this.player?(this.gameLoop=setInterval(()=>this.update(),1e3/100),!0):!1}stop(){clearInterval(this.gameLoop)}update(){this.time="Time: "+new Date(Date.now()-this.initialTime.getMilliseconds()).toLocaleString("en",{dateStyle:"medium"}),this.player.update(),this.draw()}draw(){c(this,d,g).call(this,"black"),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),c(this,d,g).call(this,this.GameColors.three),this.ctx.fillText(this.time,16,16),this.player.draw(this.ctx)}}d=new WeakSet,g=function(t){this.ctx.fillStyle=t},x=new WeakSet,T=function(t){this.ctx.strokeStyle=t};const l=document.createElement("canvas"),m=document.getElementById("usernameForm");let p;function A(){l.width=window.innerWidth-2,l.height=window.innerHeight-2,l.tabIndex="1",document.body.appendChild(l),m.addEventListener("submit",i=>{i.preventDefault();const t=i.target.elements[0].value;p=new O(t,l),window.addEventListener("keydown",e=>{e.key==="Escape"&&p.stop()}),console.log(p),p.init()?(console.log("Init done"),l.focus(),m.elements[0].classList.remove("invalid"),m.parentElement.classList.add("done")):(console.error("Init failed"),m.elements[0].classList.add("invalid"))})}A();
